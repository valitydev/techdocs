# Работа с возвратами денежных средств

## Немного о возвратах

После проведения платежа (одностадийного иди двухстадийного после выполнения этапа 
captured) определенное время существует возможность оформить возврат денежных средств
за товар/услугу (полный или частичный). Иными словами возврат это операция по возвращению
денежных средств со счета мерчанта на счет покупателя.

Возврат строго связан с инвойсом и платежом и не может превышать сумму платежа.

## Алгоритм работы

1. Пользователь/мерчант инициирует операцию возврата через личный кабинет или API
2. По связке invoice_id + payment_id происходит поиск инвойса и платежа к нему 
3. Происходит проверка существования других возвратов к данному платежу. Если они были, 
то проверяется общая сумма возврата на превышение суммы платежа. 
4. Происходит проверка наличия денежных средств на счетах мерчанта
5. В провайдер, через который проводился платеж, отправляется запрос на возврат денежных 
средств. Может завершиться как failed, так и captured.
6. HG получает статус возврата от адаптера и переводит его в конечный статус

---

Далее:
- [реализация процесса возврата денежных средств в hellgate](hg-refund-workflow.md) 